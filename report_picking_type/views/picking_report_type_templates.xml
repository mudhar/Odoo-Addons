<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <template id="report_picking_type" inherit_id="stock.report_picking">
            <xpath expr="//table" position="after">
                <!-- Add your fields or attributes here -->
                <t t-set="has_sjpb" t-value="o.picking_report_type=='SJPB'"/>
                <t t-set="has_stbj" t-value="o.picking_report_type=='STBJ'"/>
                <t t-set="has_stbn" t-value="o.picking_report_type=='STBN'"/>
                <table class="table table-condensed" t-if="has_stbj">
                    <t t-set="user_by" t-value="request.env.user.name"/>
                    <thead>
                        <tr>
                            <th><strong>Generated By</strong></th>
                            <th><strong>Generated Date</strong></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span t-esc="user_by"/></td>
                            <td><span t-field="o.generate_date" eval="(Datetime.today())"/></td>
                        </tr>
                    </tbody>
                </table>
            </xpath>

            <!--Total Roll STBN-->
            <xpath expr="//table[@t-if='o.move_line_ids']/thead/tr/th[2]" position="after">
                <!-- Add your fields or attributes here -->
                <t t-if="has_stbn and has_serial_number">
                    <th width="10%">Total Roll</th>
                </t>
            </xpath>
            <xpath expr="//table[@t-if='o.move_line_ids']/tbody/tr/td[2]" position="after">
                <!-- Add your fields or attributes here -->
                <t t-if="has_stbn and has_serial_number">
                    <t t-set="roll_count" t-value="move.mapped('move_line_ids').mapped('lot_id')"/>
                    <t t-set="roll_count_name" t-value="move.mapped('move_line_ids').mapped('lot_name')"/>
                    <td>
                        <span t-esc="len(roll_count)"/>
                        <span t-if="not roll_count" t-esc="len(roll_count_name)"/>
                    </td>
                </t>
            </xpath>

            <!-- Keterangan STBN SPJB -->
            <xpath expr="//table[@t-if='o.move_line_ids']/thead/tr/th[last()]" position="after">
                <!-- Add your fields or attributes here -->
                <t t-if="has_stbn or has_sjpb">
                    <th width="20%">
                        Keterangan
                    </th>
                </t>
            </xpath>
            <xpath expr="//table[@t-if='o.move_line_ids']/tbody/tr/td[last()]" position="after">
                <!-- Add your fields or attributes here -->
                <t t-if="has_stbn or has_sjpb">
                    <td>
                    </td>
                </t>
            </xpath>

            <!-- Note dan Tanda Tangan Box STBJ -->
            <xpath expr="//p[@t-field='o.note']" position="after">
                <!-- Add your fields or attributes here -->
                <t t-if="has_stbj">
                    <div class="clearfix">
                        <div class="row" name="total">
                            <div class="col-xs-4 pull-right">
                                <table class="table table-condensed" style="min-width: 200px;max-width: 350px;">
                                    <tr>
                                        <td><strong>Jumlah Barang Bagus:</strong></td>
                                    </tr>
                                    <tr>
                                        <td><strong>Jumlah Reject:</strong></td>
                                    </tr>
                                    <tr>
                                        <td><strong>Jumlah Perbaikan:</strong></td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                </t>
                <table class="table table-responsive" t-if="has_stbj">
                    <col width="20%"/>
                    <col width="20%"/>
                    <col width="20%"/>
                    <thead>
                        <tr>
                            <th class="text-center" style="border: 1px solid black"><strong>Received By</strong></th>
                            <th class="text-center" style="border: 1px solid black"><strong>Approved By</strong></th>
                            <th class="text-center" style="border: 1px solid black"><strong>Dibukukan Oleh</strong></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="text-center" style="padding-top:80px;border: 1px solid black"><small>Checker</small></td>
                            <td class="text-center" style="padding-top:80px;border: 1px solid black"><small>Kepala Gudang</small></td>
                            <td class="text-center" style="padding-top:80px;border: 1px solid black"><small>Admin Gudang</small></td>
                        </tr>
                    </tbody>
                </table>
            </xpath>

            <!-- Replace class="col-xs-4" -->
            <xpath expr="//div[hasclass('col-xs-4')]" position="replace">
                <!-- Add your fields or attributes here -->
                <div class="col-xs-12">
                    <span t-field="ml.lot_id"/>
                    <span t-if="not ml.lot_id" t-field="ml.lot_name"/>
                </div>
            </xpath>

            <!--Tambah No Barcode Pada Gambar Barcode -->
            <xpath expr="//table[@t-if='o.move_line_ids']/tbody/tr/td[3]" position="attributes">
                <!-- Add your fields or attributes here -->
                <attribute name="align">center</attribute>
            </xpath>
            <xpath expr="//table[@t-if='o.move_line_ids']/tbody/tr/td/t[@t-if='has_barcode']/span[last()]" position="inside">
                <!-- Add your fields or attributes here -->
                <span t-field="move.product_id.barcode"/>
            </xpath>

            <!-- Table Lebar Kain dan Berat Kain -->
            <xpath expr="//table[@t-if='o.move_line_ids']/thead/tr/th[3]" position="after">
                <!-- Add your fields or attributes here -->
                <t t-if="has_stbn">
                    <th width="10%" class="text-center">Lebar Kain</th>
                    <th width="10%" class="text-center">Berat Kain</th>
                </t>
            </xpath>
            <xpath expr="//table[@t-if='o.move_line_ids']/tbody/tr/td[3]" position="after">
                <!-- Add your fields or attributes here -->
                <t t-if="has_stbn">
                    <td> </td>
                    <td> </td>
                </t>
            </xpath>
        </template>
    </data>
</odoo>