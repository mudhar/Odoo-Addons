<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="assembly_production_cost_report">
        <t t-call="web.html_container">
            <t t-foreach="lines" t-as="line">
                <t t-call="web.internal_layout">
                    <div class="page">
                        <t t-set="currency" t-value="line['currency']"/>
                        <!-- Judul -->
                        <h1><t t-esc="line['assembly']"/></h1><br/>

                        <div class="row mt32 mb32">
                            <div class="col-xs-3">
                                <strong>Product To Be Produce</strong><br/>
                                <t t-esc="line['name']"/>
                            </div>
                            <div class="col-xs-3">
                                <strong>Routing To Be Use</strong><br/>
                                <t t-esc="line['routing_id']"/>
                            </div>
                            <div class="col-xs-3">
                                <strong>Variant</strong><br/>
                                <t t-esc="line['attributes']"/>
                            </div>
                            <t t-if="line['image']">
                                <div class="col-xs-3 pull-right">
                                    <img t-att-src="'data:image/png;base64,%s' % to_text(line['image'])"/>
                                </div>
                            </t>

                        </div>


                        <h2>Component Variants</h2>
                        <table class="table table-condensed">
                            <thead>
                                <tr>
                                    <th class="col-sm-2">Description</th>
                                    <th class="col-sm-2 text-right">Ratio</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr t-foreach="line['variant_lines']" t-as="variant">
                                    <td>
                                        <span t-att-res-id="variant['product_id'].id" res-model="product.product" view-type="form" t-esc="variant['product_id'].display_name"/>
                                    </td>

                                    <td class="text-right">
                                        <span t-esc="variant['ratio']"/>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!--Tabel Raw Material -->
                        <h2>Raw Material</h2>
                        <table class="table table-condensed">
                            <thead>
                                <tr>
                                    <th class="col-sm-2">Description</th>
                                    <th class="col-sm-2 text-right">Quantity</th>
                                    <th class="col-sm-2 text-right">Unit Cost</th>
                                    <th class="col-sm-2 text-right">Total Cost</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr t-foreach="line['raw_lines']" t-as="raw">
                                    <td>
                                        <span t-att-res-id="raw['product_id'].id" res-model="product.product" view-type="form" t-esc="raw['product_id'].name"/>
                                    </td>
                                    <td class="text-right">
                                        <span t-esc="raw['product_qty']"/> <span t-esc="raw['product_uom_id'].name" groups="product.group_uom"/>
                                    </td>
                                    <td class="text-right">
                                        <span t-esc="raw['price_unit']" t-options='{"widget": "monetary", "display_currency": currency}'/>
                                    </td>
                                    <td class="text-right">
                                        <span t-esc="raw['price_subtotal']" t-options='{"widget": "monetary", "display_currency": currency}'/>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- Tabel CMT -->
                        <h2>Aksesoris</h2>
                        <table class="table table-condensed">
                            <thead>
                                <tr>
                                    <th class="col-sm-2">Description</th>
                                    <th class="col-sm-2 text-right">Quantity</th>
                                    <th class="col-sm-2 text-right">Unit Cost</th>
                                    <th class="col-sm-2 text-right">Total Cost</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr t-foreach="line['cmt_lines']" t-as="cmt">
                                    <td>
                                        <span t-att-res-id="cmt['product_id'].id" res-model="product.product" view-type="form" t-esc="cmt['product_id'].name"/>
                                    </td>
                                    <td class="text-right">
                                        <span t-esc="cmt['product_qty']"/> <span t-esc="cmt['product_uom_id'].name" groups="product.group_uom"/>
                                    </td>
                                    <td class="text-right">
                                        <span t-esc="cmt['price_unit']" t-options='{"widget": "monetary", "display_currency": currency}'/>
                                    </td>
                                    <td class="text-right">
                                        <span t-esc="cmt['price_subtotal']" t-options='{"widget": "monetary", "display_currency": currency}'/>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- Tabel Biaya Produksi -->
                        <h2>Biaya Produksi</h2>
                        <table class="table table-condensed">
                            <thead>
                                <tr>
                                    <th class="col-sm-2">Description</th>
                                    <th class="col-sm-2 text-right">Quantity</th>
                                    <th class="col-sm-2 text-right">Unit Cost</th>
                                    <th class="col-sm-2 text-right">Total Cost</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr t-foreach="line['service_lines']" t-as="service">
                                    <td>
                                        <span t-att-res-id="service['product_id'].id" res-model="product.product" view-type="form" t-esc="service['product_id'].name"/>
                                    </td>
                                    <td class="text-right">
                                        <span t-esc="service['product_qty']"/> <span t-esc="service['product_uom_id'].name" groups="product.group_uom"/>
                                    </td>
                                    <td class="text-right">
                                        <span t-esc="service['price_unit']" t-options='{"widget": "monetary", "display_currency": currency}'/>
                                    </td>
                                    <td class="text-right">
                                        <span t-esc="service['price_subtotal']" t-options='{"widget": "monetary", "display_currency": currency}'/>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <table class="table table-condensed">
                            <tr>
                                <th colspan="6" class="text-right">Total</th>
                                <th class="text-right">
                                    <span t-esc="line['total']" t-options='{"widget": "monetary", "display_currency": currency}'/>
                                </th>
                            </tr>
                        </table>

                    </div>
                </t>
            </t>
        </t>
    </template>
</odoo>